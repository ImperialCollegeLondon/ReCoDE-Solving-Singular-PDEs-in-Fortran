# Initial Documentation for ReCoDE

The goal of this exemplar will be to solve Predator-Prey Models of the form
$$u_t = \epsilon \Delta u + uf(u) - vg(u), \quad v_t =  \Delta v + vh(u), $$
where $u$ is the prey, $v$ is the predator, $\epsilon >0$ is some small parameter and $f,g$ and $h$ are given functions. 

This equation is initially quite complicated: 

  - it is a coupled PDE in two varaibles ($u$ and $v$)
  - in time it is parabolic so requires temporal marching,
  - in space it is elliptic and so must be solved as a boundary value problem,
  - depending on $f,g$ and $h$ the equation may be non-linear in $u$ and $v$ and therefore may require shooting methods or a lag in time approach,
  - $\epsilon$ being a small variable forces problem to be a singular boundary value problem in space and thus requires some technique to resolve the length scales near a particular boundary. Here will make use of a streched grid.

Initial/boundary conditions need to be specified and decided upon. 

The biology of this model is very wide ranged; in particular in 2D it can be used to explain Turing patterns or the stripes/spots on various animals. This is an example of a singularly perturbed equation (https://en.wikipedia.org/wiki/Singular_perturbation) and the mathematics of this problem are discussed here [Owen, M. R. and Lewis, M. A. "How Predation can Slow, Stop, or Reverse a Prey Invasion", Bulletin of Mathematical Biology (2001) 63, 655-684.] 

Note: need to spend a bit more time studying the non-linearites of the final decided problem, but ideally we will keep it quite simple with $f(u),g(u),h(u) = 0,1,u,u^2$ or similar. This will effect the von-Neumann stability conditions. Importantly, $f,g$ and $h$ will never take the derivatives of $u$ or $v$.


### Steps: 

**STEP 1**
1. Build a boundary value solver using finite differences:
   - 1D problem
   - $u_{xx} = u$ on with prescribed Neumann or Dirichlet boundary conditions
2. Discretise using finite differences + compressed storage (or Chebyshev polynomials) - will hopefully use an external package to help with this! (Any tips?) 
3. Then use some linear algebra package that works with FPM to solve the problem.
4. Compare with analytic solutions

**STEP 2**
1. We now want to add in the small parameter - modify the equation to this form:
   $$\epsilon u'' + (1+\epsilon)u' + u = 0,\quad u(0) = 0, u(1) = 1, 0<\epsilon<<0 $$
   (https://en.wikipedia.org/wiki/Method_of_matched_asymptotic_expansions#Method_overview)
This problem now has boundary layer formed at one of the boundaries which is due to the small paramater $\epsilon$; in the limit $\epsilon\rightarrow 0$ we are left with a first order equation whose solutions posesses one unknown. This unknown can be found using the boundary condition at $x=1$, however the first order solution will not satisfy the boundary condition at $x=0$. For a small region about the boundary $x=0$, the solution will not be the first order solution but truly second order. This can be overcome using the technique of matched asymptotic expansion and numerically it can be tackled via a streched grid. (Note for this equation it's easy to write down the exact analytic solution but this is not always the case.)

This is fairly straightforward to implement, however grid streching metrics must be calculated.

3. Compare results with analytic solution.

**Step 3** 
1. Heat equation:
  $$u_t = u_{xx}$$ with prescribed boundary and initial conditions. 
 Now we want to march forward in time using some package.
https://computing.llnl.gov/projects/odepack, https://people.sc.fsu.edu/~jburkardt/f77_src/odepack/odepack.html ???

**Step 4** 
1. Modify the heat equation to solve
  $$u_t = u_{xx},\quad v_t = v_{xx} $$
as a coupled system. Can discuss von Neumann stability conditions.
2. Include true coupling
  $$u_t = u_{xx} +u+v ,\quad v_t = v_{xx}+v+u$$
as a coupled system. Solutions should be identical as a test.

**Step 5** 
1. Add in second spatial dimension
    $$u_t = \Delta u +u+v ,\quad v_t = \Delta v +v+u$$

**Step 6**
1. Add in non linearities. This can be done 'simply' with a lagging time step where the non-linearities as calculated at the previous time step. If we are at time step $i$ then we have the forced problem

$${(u_t - \epsilon \Delta u)}_{i} = (F(u,v)) _{i-1}$$

$${(v_t - \epsilon \Delta v)}_{i} = (G(u,v)) _{i-1}$$
where $F,G$ are the non-linear functions. 


 








